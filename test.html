{% extends 'base.html' %}
{% block title %}Test - ExamPro{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-8">
    <div class="glass p-3 position-relative">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Live Camera Feed</h5>
        <div>
          <span class="badge bg-dark">Session: {{ session_id }}</span>
        </div>
      </div>

      <div class="video-border" style="position:relative; width:100%; max-width:720px;">
        <video id="video" autoplay playsinline width="720" height="540" style="display:block;"></video>
        <canvas id="overlay" width="720" height="540" style="position:absolute; top:0; left:0; pointer-events:none;"></canvas>
      </div>

      <div class="mt-3 d-flex gap-3">
        <button id="startBtn" class="btn btn-success btn-glow">Start Camera</button>
        <button id="stopBtn" class="btn btn-danger">Stop</button>
        <button id="finishBtn" class="btn btn-primary">Finish Test</button>
        <div class="ms-auto align-self-center">Timer: <span id="timer">00:00</span></div>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="glass p-3">
      <h5>AI Monitoring</h5>
      <ul>
        <li>Face Detected: <span id="faceDetected">—</span></li>
        <li>Gaze (est.): <span id="gaze">—</span></li>
        <li>Blink: <span id="blink">—</span></li>
        <li>Mouth: <span id="mouth">—</span></li>
        <li>Suspicion Score: <strong id="suspicion">0%</strong></li>
      </ul>
      <div id="alertArea"></div>
    </div>
  </div>
</div>

<script>
const sessionId = "{{ session_id }}";
</script>
{% endblock %}
